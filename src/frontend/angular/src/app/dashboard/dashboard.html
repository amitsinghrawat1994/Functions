<div class="dashboard-container">
  <header class="dashboard-header">
    <h2>Dashboard</h2>
    <div class="user-info" *ngIf="authService.user$ | async as user">
      <p>Welcome, {{ user.name || user.email }}!</p>
      <button (click)="logout()" class="btn btn-secondary">Logout</button>
    </div>
  </header>

  <div class="dashboard-content">
    <!-- User Profile Section -->
    <section class="profile-section">
      <h3>User Profile</h3>
      <div *ngIf="userProfile; else noProfile">
        <p><strong>User ID:</strong> {{ userProfile.UserId }}</p>
        <p><strong>Email:</strong> {{ userProfile.Email }}</p>
        <p><strong>Name:</strong> {{ userProfile.Name }}</p>
        <p><strong>Email Verified:</strong> {{ userProfile.EmailVerified ? 'Yes' : 'No' }}</p>
      </div>
      <ng-template #noProfile>
        <p>Loading profile...</p>
      </ng-template>
      <button (click)="loadUserProfile()" class="btn btn-primary">Refresh Profile</button>
    </section>

    <!-- Protected Data Section -->
    <section class="data-section">
      <h3>Protected Data</h3>
      <div *ngIf="protectedData; else noData">
        <p><strong>Message:</strong> {{ protectedData.Message }}</p>
        <p><strong>User ID:</strong> {{ protectedData.UserId }}</p>
        <p><strong>Timestamp:</strong> {{ protectedData.Timestamp | date : 'medium' }}</p>
        <div>
          <strong>Data:</strong>
          <ul>
            <li *ngFor="let item of protectedData.Data">{{ item }}</li>
          </ul>
        </div>
      </div>
      <ng-template #noData>
        <p>Loading data...</p>
      </ng-template>
      <button (click)="loadProtectedData()" class="btn btn-primary">Refresh Data</button>
    </section>

    <!-- Create Data Section -->
    <section class="create-section">
      <h3>Create Data</h3>
      <input [(ngModel)]="newData" placeholder="Enter data" class="form-input" />
      <button (click)="createData()" class="btn btn-primary">Create</button>
      <div *ngIf="createResult" class="result">
        <p>Created: {{ createResult.Id }}</p>
      </div>
    </section>

    <!-- Admin Section (if user has admin role) -->
    <section class="admin-section" *ngIf="isAdmin()">
      <h3>Admin Functions</h3>
      <button (click)="loadUsers()" class="btn btn-primary">Load Users</button>
      <div *ngIf="users.length > 0">
        <h4>Users:</h4>
        <ul>
          <li *ngFor="let user of users">{{ user.Name }} - {{ user.Email }}</li>
        </ul>
      </div>
    </section>
  </div>
</div>
